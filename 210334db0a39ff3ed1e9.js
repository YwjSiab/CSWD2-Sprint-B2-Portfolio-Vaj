import{describe,it,expect}from"vitest";import{sanitizeInput}from"../src/security.js";describe("sanitizeInput",()=>{it("removes HTML tags and escapes dangerous characters",()=>{const t=sanitizeInput("<script>alert('xss')<\/script> Hello & <b>World</b>");expect(t).not.toMatch(/<\s*script/i),expect(t).not.toMatch(/<\s*b\s*>/i),expect(t).not.toContain("&lt;b&gt;"),expect(t).toContain("Hello &amp; World"),expect(t).toContain("alert(&#039;xss&#039;)"),expect(t).not.toContain("<"),expect(t).not.toContain(">")}),it("returns empty string safely on error",()=>{const t=sanitizeInput(null);expect(t).toBe("")})});